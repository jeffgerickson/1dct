<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>27-planarization</title>
  <style>
    html {
      font-size: 18px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 50em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 data-number="1" id="planarization-and-separationalphabeta"><span
class="header-section-number">1</span> Planarization and Separation<span
class="math inline">\(^{\alpha/\beta}\)</span></h1>
<p>In this note I’ll describe how to generalize several results about
planar separators to more complex surface maps. These generalizations
imply reductions from several problems on arbitrary surface maps to
related (or even identical) problems on planar graphs, possibly with
larger complexity.</p>
<p>The first step in any such reduction is to either delete or slice a
subgraph of the input map to remove any interesting topology. We’ve
already seen one example of such a subgraph: A <em>cut graph</em> in a
surface map <span class="math inline">\(\Sigma\)</span> is a subgraph
<span class="math inline">\(X\)</span> such that the sliced surface
<span class="math inline">\(\Sigma \mathbin{\backslash\!\!\backslash}
X\)</span> is a disk. Unfortunately, it is easy to construct surface
maps in which every cut graph uses a constant fraction of the edges, and
we need sublinear complexity to support efficient reductions.</p>
<p>So instead we consider a weaker structure. A <em>planarizing</em> or
<em>degenerating<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> subgraph</em> of <span
class="math inline">\(\Sigma\)</span> is any subgraph <span
class="math inline">\(X\)</span> such that the sliced surface <span
class="math inline">\(\Sigma \mathbin{\backslash\!\!\backslash}
X\)</span> has genus <span class="math inline">\(0\)</span>, but
possibly with more than one boundary cycle. Once we have planarizing
subgraphs with sublinear complexity, we can use standard
planar-separator techniques to balanced separators with sublinear
complexity.</p>
<p>Throughout this note, we fix a surface <em>triangulation</em> <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and Euler genus <span
class="math inline">\(\bar{g} = o(n)\)</span>. (Surface maps with Euler
genus <span class="math inline">\(\Omega(n)\)</span> do not have small
planarizing subgraphs or small separators.) Euler’s formula implies that
<span class="math inline">\(\Sigma\)</span> has exactly <span
class="math inline">\(3n-6+3\bar{g} &lt; 6n\)</span> edges and <span
class="math inline">\(2n-4+2\bar{g} &lt; 4n\)</span> faces.</p>
<h2 data-number="1.1" id="multiple-short-cycles"><span
class="header-section-number">1.1</span> Multiple Short Cycles</h2>
<p><strong>Lemma:</strong> <em>Let <span
class="math inline">\(\sigma\)</span> and <span
class="math inline">\(\tau\)</span> be cycles in a surface map <span
class="math inline">\(\Sigma\)</span>. If either <span
class="math inline">\(\sigma\)</span> or <span
class="math inline">\(\tau\)</span> is a separating cycle, then <span
class="math inline">\(\sigma\)</span> and <span
class="math inline">\(\tau\)</span> cross an even number of times.
Equivalently, if <span class="math inline">\(\sigma\)</span> and <span
class="math inline">\(\tau\)</span> cross an odd number of times, both
<span class="math inline">\(\sigma\)</span> and <span
class="math inline">\(\tau\)</span> are nonseparating.</em></p>
<p><strong>Lemma [Albertson and Hutchinson]:</strong> <em>Every
orientable surface triangulation contains a nonseparating cycle of
length at most <span class="math inline">\(2\sqrt{n}\)</span>.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Let <span class="math inline">\(\Sigma\)</span> be an orientable surface
triangulation, and let <span class="math inline">\(\sigma\)</span> be
the shortest nonseparating cycle in <span
class="math inline">\(\Sigma\)</span>. Let <span
class="math inline">\(\sigma^\flat\)</span> and <span
class="math inline">\(\sigma^\sharp\)</span> denote the two copies of
<span class="math inline">\(\sigma\)</span> in the sliced map <span
class="math inline">\(\Sigma\mathbin{\backslash\!\!\backslash}
\sigma\)</span>, and let <span class="math inline">\(m\)</span> denote
the number of vertices in <span class="math inline">\(\sigma\)</span>.
</dd>
<dd>
<p>Let <span class="math inline">\(S\)</span> be the smallest subset of
vertices of <span
class="math inline">\(\Sigma\mathbin{\backslash\!\!\backslash}
\sigma\)</span> that separates <span
class="math inline">\(\sigma^\flat\)</span> and <span
class="math inline">\(\sigma^\sharp\)</span>. The subgraph of <span
class="math inline">\(\Sigma\)</span> induced by <span
class="math inline">\(S\)</span> must contain (and therefore must
<em>be</em>) a cycle <span class="math inline">\(\tau\)</span> that is
homologous with <span class="math inline">\(\sigma\)</span> and
therefore nonseparating. Thus, <span class="math inline">\(\tau\)</span>
has at least <span class="math inline">\(m\)</span> vertices. Menger’s
Theorem now immediately implies that there are at least <span
class="math inline">\(m\)</span> vertex-disjoint paths from <span
class="math inline">\(\sigma^\flat\)</span> to <span
class="math inline">\(\sigma^\sharp\)</span> in <span
class="math inline">\(\Sigma\mathbin{\backslash\!\!\backslash}
\sigma\)</span>.</p>
</dd>
<dd>
<p>On the other hand, let <span class="math inline">\(\pi\)</span> be
the shortest path in <span
class="math inline">\(\Sigma\mathbin{\backslash\!\!\backslash}
\sigma\)</span> from a node in <span
class="math inline">\(\sigma^\flat\)</span> to its clone in <span
class="math inline">\(\sigma^\sharp\)</span>. The edges of <span
class="math inline">\(\pi\)</span> comprise a cycle in <span
class="math inline">\(\Sigma\)</span> that crosses <span
class="math inline">\(\sigma\)</span> once and thus is nonseparating. It
follows that <span class="math inline">\(\pi\)</span> has length at
least <span class="math inline">\(m\)</span>. At most <span
class="math inline">\(m/2\)</span> edges in <span
class="math inline">\(\pi\)</span> lie in either <span
class="math inline">\(\sigma^\flat\)</span> or <span
class="math inline">\(\sigma^\sharp\)</span>. Thus, every path from
<span class="math inline">\(\sigma^\flat\)</span> to <span
class="math inline">\(\sigma^\sharp\)</span> has at least <span
class="math inline">\(m/2\)</span> edges.</p>
</dd>
<dd>
<p>We conclude that <span class="math inline">\(n\ge m^2/2\)</span>.
<span class="math inline">\(\qquad\square\)</span></p>
</dd>
</dl>
<p>Alberston and Hutchinson’s proof requires orientability. If <span
class="math inline">\(\sigma\)</span> is a one-sided cycle in a
nonorientable surface map <span class="math inline">\(\Sigma\)</span>,
the sliced map <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} \sigma\)</span> has a single boundary
cycle that covers <span class="math inline">\(\sigma\)</span> twice.
However, a similar result can be proved for nonorientable surface maps
by considering the oriented double cover <span
class="math inline">\(\Sigma^2\)</span>.</p>
<p><strong>Corollary [Gilbert, Hutchinson, and Tarjan]:</strong> <em>Any
surface map <span class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and genus <span
class="math inline">\(g\)</span> can be transformed into a genus-<span
class="math inline">\(0\)</span> map by slicing along <span
class="math inline">\(g\)</span> cycles of total length <span
class="math inline">\(O(g\sqrt{n})\)</span>.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Let <span class="math inline">\(\Sigma\)</span> be an orientable surface
map with genus <span class="math inline">\(g\)</span>. Without loss of
generality, we can assume that <span
class="math inline">\(\Sigma\)</span> is a simple triangulation;
otherwise, remove all loops, remove all but one edge in every family of
homotopic parallel edges, and triangulate every face with more than
three sides. If <span class="math inline">\(g=0\)</span>, there is
nothing to do, so assume otherwise. Let <span
class="math inline">\(\sigma\)</span> be the shortest noncontractible
cycle in <span class="math inline">\(\Sigma\)</span>. The map <span
class="math inline">\(\Sigma’ = \Sigma\mathbin{\backslash\!\!\backslash}
\sigma\)</span> has at most <span class="math inline">\(n +
2\sqrt{n}\)</span> edges has genus <span
class="math inline">\(g-1\)</span>. The result now follows by induction.
<span class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<p>Hutchinson proved that every orientable surface triangulation
contains a noncontractible cycle of length <span
class="math inline">\(O(\sqrt{n/g} \log g)\)</span>; the same inductive
argument implies that we can planarize any orientable surface map by
slicing along <span class="math inline">\(g\)</span> cycles of total
length <span class="math inline">\(O(\sqrt{ng} \log g)\)</span>. Colin
de Verdière, Hubard, and Lazarus proved that there are surface maps in
which every noncontractible cycle has length at least <span
class="math inline">\(\Omega(\sqrt{n/g} \log g)\)</span>; so
Hutchinson’s bound is tight in the worst case. Nevertheless it is
possible to compute (slightly) smaller planarizing subgraphs.</p>
<h2 data-number="1.2" id="slabification"><span
class="header-section-number">1.2</span> Slabification</h2>
<p>The following construction of a smaller planarizing subgraph is based
on results of David Eppstein, which refines an earlier construction of
Aleksandrov and Djidjev; similar techniques were also described by
Hutchinson and Miller. Eppstein’s construction uses the same notion of
<em>depth contours</em> as Miller’s planar cycle-separator algorithm,
which we saw in Chapter 12.</p>
<p>Without loss of generality, assume that <span
class="math inline">\(\Sigma\)</span> is a simple triangulation. We
start by building a tree-cotree decomposition <span
class="math inline">\((T, L, C)\)</span>, where <span
class="math inline">\(T\)</span> is a breadth-first spanning tree rooted
at an arbitrary source vertex <span class="math inline">\(s\)</span>.
For any vertex <span class="math inline">\(v\)</span>, let <span
class="math inline">\(\textsf{depth}(v)\)</span> denote the unweighted
shortest-path distance from <span class="math inline">\(s\)</span> to
<span class="math inline">\(v\)</span>, and define the depth of an edge
or face to be the maximum depth of its vertices.</p>
<p>For any index <span class="math inline">\(j\)</span>, the <span
class="math inline">\(j\)</span>th <em>depth contour</em> <span
class="math inline">\(D_j\)</span> of <span
class="math inline">\(\Sigma\)</span> is the subgraph induced by edges
incident to both a face with depth <span
class="math inline">\(j\)</span> and a face with depth <span
class="math inline">\(j+1\)</span>.</p>
<p>For any integers <span class="math inline">\(i&lt;j\)</span>, let
<span class="math inline">\(\Sigma[i,j]\)</span> denote the subcomplex
of <span class="math inline">\(\Sigma\)</span> containing all faces
<span class="math inline">\(f\)</span> such that <span
class="math inline">\(i &lt; \textsf{depth}(f) \le j\)</span>, along
with their incident edges and vertices; notice that the range of
face-depths excludes the lower index <span
class="math inline">\(i\)</span>. We refer to <span
class="math inline">\(\Sigma[i,j]\)</span> as a <em>slab</em> of <span
class="math inline">\(\Sigma\)</span>. In particular, <span
class="math inline">\(\Sigma[0,j]\)</span> is the subcomplex of
vertices, edges, and faces with depth at most <span
class="math inline">\(j\)</span>, or equivalently, the component of
<span class="math inline">\(\Sigma \mathbin{\backslash\!\!\backslash}
D_j\)</span> containing <span class="math inline">\(s\)</span>. The
boundary of <span class="math inline">\(\Sigma[i,j]\)</span> naturally
partitions into its <em>upper</em> boundary <span
class="math inline">\(D_{i-1}\)</span> and its <em>lower</em> boundary
<span class="math inline">\(D_j\)</span>.</p>
<p>For any subset <span class="math inline">\(L’ \subseteq L\)</span>,
let <span class="math inline">\(Q(L’) = \bigcup \{ \textsf{loop}_T(\ell)
\mid \ell\in L’ \}\)</span>. In particular, <span
class="math inline">\(Q(L)\)</span> is a (possibly unreduced) <span
class="math inline">\(Q\)</span>ut graph of <span
class="math inline">\(\Sigma\)</span>, and <span
class="math inline">\(Q(\varnothing)\)</span> is the empty subgraph.</p>
<p>Finally, for all indices <span class="math inline">\(i&lt;j\)</span>,
let <span class="math inline">\(L[i,j] = L\cap \Sigma[i,j]\)</span> and
<span class="math inline">\(Q[i,j] = \Sigma[i,j] \cap
Q(L[i,j])\)</span>. Each subgraph <span
class="math inline">\(Q[i,j]\)</span> contains all edges <span
class="math inline">\(\ell\in L[i,j]\)</span>, along with shortest paths
(through <span class="math inline">\(T\)</span>) from the endpoints of
<span class="math inline">\(\ell\)</span> “up” to the depth contour
<span class="math inline">\(D_{i-1}\)</span>.</p>
<p><strong>Lemma:</strong> <em>For all indices <span
class="math inline">\(i&lt;j\)</span>, <span
class="math inline">\(Q[i,j]\)</span> is a planarizing subgraph of <span
class="math inline">\(\Sigma[i,j]\)</span>.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Every submap of a genus-<span class="math inline">\(0\)</span> map has
genus <span class="math inline">\(0\)</span>, so it suffices to consider
the spacial case <span class="math inline">\(i=0\)</span>. Let <span
class="math inline">\(\Sigma’\)</span> be the surface map obtained from
<span class="math inline">\(\Sigma[0,j]\)</span> by gluing a disk to
each boundary cycle.
</dd>
<dd>
<p>The intersection <span class="math inline">\(T’ = T \cap
\Sigma’\)</span> is a breadth-first spanning tree of <span
class="math inline">\(\Sigma[0,j]\)</span>, consisting of the first
<span class="math inline">\(j\)</span> levels of the global
breadth-first spanning tree tree <span
class="math inline">\(T\)</span>.</p>
</dd>
<dd>
<p>The intersection <span class="math inline">\(C \cap \Sigma’\)</span>
defines a forest in the dual map <span
class="math inline">\((\Sigma’)^*\)</span>, which spans every face
except the caps. We can extend this coforest to a spanning cotree <span
class="math inline">\(C’\)</span> by adding edges that are not in <span
class="math inline">\(T’\)</span> (in fact, only edges on the boundary
of <span class="math inline">\(\Sigma[0,j]\)</span>).</p>
</dd>
<dd>
<p>Thus, we have a tree-cotree decomposition <span
class="math inline">\((T’, L’, C’)\)</span> of <span
class="math inline">\(\Sigma’\)</span>, where <span
class="math inline">\(L’ = E(\Sigma’) \setminus (C’ \cup T’) \subseteq
L[0,j]\)</span>. It follows that <span class="math inline">\(Q’ =
Q(L’)\)</span> is a cut graph for <span
class="math inline">\(\Sigma’\)</span>. On the other hand, <span
class="math inline">\(Q’\)</span> is a subgraph of <span
class="math inline">\(Q[i,j]\)</span>. <span
class="math inline">\(\qquad\square\)</span></p>
</dd>
</dl>
<p>For any integers <span class="math inline">\(0 \le i &lt; k\)</span>,
let <span class="math inline">\(D(i,k) = \bigcup\{D_j \mid j\bmod k =
i\}\)</span>. Slicing <span class="math inline">\(\Sigma\)</span> along
these depth contours patitions it into several slabs: <span
class="math display">\[  
    \Sigma \mathbin{\backslash\!\!\backslash} D(i,k)
    =
    \bigcup_a \Sigma[ak+i, (a+1)k+i].
\]</span> Let <span class="math inline">\(Q(i,k)\)</span> denote the
corresponding subgraph of the cut graph <span
class="math inline">\(Q(L)\)</span>: <span class="math display">\[
    Q(i,k) = \bigcup_a Q[ak+i, (a+1)k+i].
\]</span> Finally, let <span class="math inline">\(P(i,k) = D(i,k) \cup
Q(i,k)\)</span>. The previous lemma implies that <span
class="math inline">\(P(i,k)\)</span> is a planarizing subgraph of <span
class="math inline">\(\Sigma\)</span>, for all indices <span
class="math inline">\(i\)</span> and <span
class="math inline">\(k\)</span>.</p>
<p><strong>Lemma:</strong> <em>For some integers <span
class="math inline">\(i\)</span> and <span
class="math inline">\(k\)</span>, the subgraph <span
class="math inline">\(P(i,k)\)</span> has at most <span
class="math inline">\(2\sqrt{\bar{g}n}\)</span> vertices.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
For each endpoint <span class="math inline">\(v\)</span> of each edge in
<span class="math inline">\(L\)</span>, the subgraph <span
class="math inline">\(Q(i,k)\)</span> contains the shortest path from
<span class="math inline">\(v\)</span> to its nearest ancestor in <span
class="math inline">\(T\)</span> that lies on the depth contour <span
class="math inline">\(D(i,k)\)</span>. This path has length <span
class="math inline">\((\textsf{depth}(v) - i) \bmod k\)</span>.
Moreover, <span class="math inline">\(Q(i,k)\)</span> is the union of
all <span class="math inline">\(\bar{g}\)</span> such subpaths with
<span class="math inline">\(L\)</span>. It follows that for any fixed
<span class="math inline">\(k\)</span>, we have <span
class="math display">\[
\sum_{i=0}^{k-1} |V(Q(i,k))|
\le
\sum_{v\in V(L)} \sum_{i=0}^{k-1} (\textsl{depth}(v) - i)\bmod k
=
\bar{g} k(k-1) &lt; \bar{g}k^2.
\]</span> Each vertex and edge of <span
class="math inline">\(\Sigma\)</span> belongs to at most one depth
contour <span class="math inline">\(D_i\)</span>, so <span
class="math display">\[
\sum_{i=0}^{k-1} |V(D(i,k))| \le n.
\]</span> We conclude that <span class="math display">\[
\sum_{i=0}^{k-1} |V(P(i,k))| \le \bar{g}k^2 + n
\]</span> which implies that for some index <span
class="math inline">\(i\)</span>, the subgraph <span
class="math inline">\(P(i,k)\)</span> has at most <span
class="math inline">\(\bar{g}k + n/k\)</span> vertices. In particular,
some subgraph <span class="math inline">\(P(i,\sqrt{n/\bar{g}})\)</span>
has at most <span class="math inline">\(2\sqrt{\bar{g}n}\)</span>
vertices.<a href="#fn2" class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a> <span
class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<p>Let <span class="math inline">\(k^* = \sqrt{n/\bar{g}}\)</span>, and
let <span class="math inline">\(i^*\)</span> be the index <span
class="math inline">\(i\)</span> that minimizes the number of vertices
in <span class="math inline">\(P(i, k^*)\)</span>. Euler’s formula
implies that <span class="math inline">\(P(i^*, k^*)\)</span> has at
most <span class="math inline">\(12\sqrt{\bar{g}n}\)</span> edges.</p>
<p><strong>Theorem:</strong> <em>Every surface triangulation <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and Euler genus <span
class="math inline">\(\bar{g} &lt; n\)</span> has a planarizing subgraph
<span class="math inline">\(P(i^*, k^*)\)</span> with <span
class="math inline">\(O(\sqrt{\bar{g}n})\)</span> vertices and edges,
which can be computed in <span class="math inline">\(O(n)\)</span>
time.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
We can compute the breadth-first spanning tree <span
class="math inline">\(T\)</span> and the depths of every vertex, edge,
and face of <span class="math inline">\(\Sigma\)</span> in <span
class="math inline">\(O(n)\)</span> time via (surprise, surprise)
breadth-first search. Computing the depth contours <span
class="math inline">\(D_j\)</span>, the number of vertices in each
subgraph <span class="math inline">\(D(i,k^*)\)</span>, and the optimal
index <span class="math inline">\(i^*\)</span> in <span
class="math inline">\(O(n)\)</span> time is straightforward. Then for
each endpoint <span class="math inline">\(v\)</span> of each edge in
<span class="math inline">\(L\)</span>, we walk upward in <span
class="math inline">\(T\)</span> marking edges, until we encounter
either a marked edge or a vertex in <span
class="math inline">\(D(i^*,k^*\)</span>)$. Because each edge of <span
class="math inline">\(\Sigma\)</span> is marked at most once, the total
time to find the marked edges is their number plus <span
class="math inline">\(O(\bar{g})\)</span>, which is <span
class="math inline">\(O(n)\)</span>. The marked edges and <span
class="math inline">\(L\)</span> comprise the subgraph <span
class="math inline">\(Q(i^*,k^*)\)</span>. <span
class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<p><strong>Corollary:</strong> <em>Every surface triangulation <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and Euler genus <span
class="math inline">\(\bar{g} &lt; n\)</span> has a <span
class="math inline">\((3/4)\)</span>-separator with <span
class="math inline">\(O(\sqrt{\bar{g}n})\)</span> vertices and edges,
which can be computed in <span class="math inline">\(O(n)\)</span>
time.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
The sliced surface <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} P(i^*, k^*)\)</span> has at most one
component with more than <span class="math inline">\(3/4\)</span> of the
faces of <span class="math inline">\(\Sigma\)</span>. If there is such a
component, apply the planar separator theorem within that component.
<span class="math inline">\(\qquad\square\)</span>.
</dd>
</dl>
<h2 data-number="1.3" id="nice-r-divisions"><span
class="header-section-number">1.3</span> Nice <span
class="math inline">\(r\)</span>-divisions</h2>
<p>A <em>nice <span class="math inline">\(r\)</span>-division</em> of a
surface map <span class="math inline">\(\Sigma\)</span> is a subdivision
of <span class="math inline">\(\Sigma\)</span> into subcomplexes called
<em>pieces</em> with the following properties:</p>
<ul>
<li>Every face of <span class="math inline">\(\Sigma\)</span> lies in
exactly one piece.</li>
<li>There are <span class="math inline">\(O(n/r)\)</span> pieces.</li>
<li>Each piece has <span class="math inline">\(O(r)\)</span>
vertices.</li>
<li>Each piece has <span class="math inline">\(O(\sqrt{r})\)</span>
<em>boundary</em> vertices.</li>
<li>Each piece has <span class="math inline">\(O(1)\)</span>
<em>holes</em> (boundary cycles).</li>
<li>Each piece has genus <span class="math inline">\(0\)</span>.</li>
</ul>
<p>This definition is identical to our definition of nice <span
class="math inline">\(r\)</span>-divisions of planar maps, except for
the last condition, which is obviously redundant if <span
class="math inline">\(\Sigma\)</span> has genus <span
class="math inline">\(0\)</span>. The definition implies that any nice
<span class="math inline">\(r\)</span>-division has a total of <span
class="math inline">\(O(n/\sqrt{r})\)</span> boundary vertices.</p>
<p>Now suppose we wanted to extend our planarizing subgraph <span
class="math inline">\(P(i^*, k^*)\)</span> to obtain a nice <span
class="math inline">\(r\)</span>-division. The number of vertices in
<span class="math inline">\(P(i^*, k^*)\)</span> suggests we should try
<span class="math inline">\(r = O(n/\bar{g})\)</span>. Unfortunately,
the partition <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} P(i^*, k^*)\)</span> has <span
class="math inline">\(\Theta(\sqrt{\bar{g}n})\)</span> face-connected
componentnts, which is more than the <span
class="math inline">\(O(\bar{g})\)</span> pieces we need for a nice
<span class="math inline">\(O(n/\bar{g})\)</span>-division. Moreover, we
have no control over the number of vertices, boundary vertices, and
holes in each individual piece of <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} P(i^*, k^*)\)</span>.</p>
<p>We can modify <span class="math inline">\(P(i^*, k^*)\)</span> to
obtain a nice <span class="math inline">\(r\)</span>-division, first by
removing redundant cycles, and then by adding cycles to make the pieces
nice.</p>
<p>First, consider the face-connected fragments of the map <span
class="math inline">\(\Sigma \mathbin{\backslash\!\!\backslash} D(i^*,
k^*)\)</span> obtained by slicing only along the short depth contours
<span class="math inline">\(D(i^*,k^*)\)</span>. We call each fragment
<em>interesting</em> if it contains at least one path through <span
class="math inline">\(T\)</span> from an endpoint of an edge in <span
class="math inline">\(L\)</span> to the upper boundary of that fragment.
There are clearly at most <span class="math inline">\(2\bar{g}\)</span>
interesting fragments. Let <span
class="math inline">\(U(i^*,k^*)\)</span> denote the Union of the Upper
boundaries of the interesting fragments, and let <span
class="math inline">\(P’(i^*,k^*) = U(i^*,k^*) \cup
Q(i^*,k^*)\)</span>.</p>
<p><strong>Lemma:</strong> <em><span
class="math inline">\(P’(i^*,k^*)\)</span> is a planarizing subgraph of
<span class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(O(\sqrt{\bar{g}n})\)</span> vertices and edges.
Moreover, <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} P’(i^*, k^*)\)</span> consists of
<span class="math inline">\(O(\bar{g})\)</span> face-connected
fragments.</em></p>
<p>The subgraph <span class="math inline">\(P’(i^*, k^*)\)</span>
induces a partition <span class="math inline">\(\mathcal{P}\)</span> of
<span class="math inline">\(\Sigma\)</span> into <span
class="math inline">\(O(\bar{g})\)</span> genus-<span
class="math inline">\(0\)</span> pieces, with a <em>total</em> of <span
class="math inline">\(O(\sqrt{\bar{g}n})\)</span> boundary vertices and
<span class="math inline">\(O(\bar{g})\)</span> holes. But the vertices,
boundary vertices, and holes are not distributed evenly among the
pieces, so we do not yet have a nice <span
class="math inline">\(O(n/\bar{g})\)</span>-division. We apply a variant
of the algorithm of Klein, Mozes, and Sommer to construct a nice <span
class="math inline">\(O(n/bar{g})\)</span>-division of each
face-connected fragment of <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} P’(i^*, k^*)\)</span> in three
phases.</p>
<ul>
<li><p>We repeatedly split pieces with more than <span
class="math inline">\(n/\bar{g}\)</span> vertices using balanced cycle
separators, until every piece has at most <span
class="math inline">\(n/bar{g})\)</span> vertices. This phase requires
at most <span class="math inline">\(O(\bar{g})\)</span> splits. Naively,
if we compute each cycle separator independently, the total time for
this phase of the algorithm is <span class="math inline">\(O(n\log
g)\)</span>, but the time reduces to <span
class="math inline">\(O(n)\)</span> if we use the faster
Klein-Mozes-Sommer algorithm. The total number of boundary vertices at
the end of this phase is <span
class="math inline">\(O(\sqrt{\bar{g}n})\)</span>.</p></li>
<li><p>Next, we repeatedly split pieces whose boundary has more than
<span class="math inline">\(\sqrt{n/\bar{g}}\)</span> vertices until no
such pieces remain. We split each piece by giving each boundary vertex
weight <span class="math inline">\(1\)</span> and each interior vertex
weight <span class="math inline">\(0\)</span>, and then computing a
balanced cycle separator. Finding a cycle separator in a piece with
<span class="math inline">\(O(n/\bar{g})\)</span> vertices takes <span
class="math inline">\(O(n/\bar{g})\)</span> time. This phase requires at
most <span class="math inline">\(O(\bar{g})\)</span> splits to evenly
partition the <span class="math inline">\(O(\sqrt{\bar{g}n})\)</span>
boundary vertices, so the total time for this phase is <span
class="math inline">\(O(n)\)</span>, even if we compute each cycle
separator independently.</p></li>
<li><p>Finally, we repeatedly split pieces that have more than (say)
<span class="math inline">\(20\)</span> boundary cycles until no such
pieces remain. We split each piece by triangulating each hole with one
additional vertex, giving the added vertices weight <span
class="math inline">\(1\)</span> and all other vertices weight <span
class="math inline">\(0\)</span>, and then computing a balanced cycle
separator. Finding a cycle separator in a piece with <span
class="math inline">\(O(n/\bar{g})\)</span> vertices takes <span
class="math inline">\(O(n/\bar{g})\)</span> time. This phase requires at
most <span class="math inline">\(O(\bar{g})\)</span> splits to evenly
partition the <span class="math inline">\(O(\bar{g})\)</span> holes, so
the total time for this phase is <span
class="math inline">\(O(n)\)</span>.</p></li>
</ul>
<p><strong>Theorem:</strong> <em>Given a surface map <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and Euler genus <span
class="math inline">\(\bar{g} = o(n)\)</span>, we can compute a nice
<span class="math inline">\((n/\bar{g})\)</span>-division of <span
class="math inline">\(\Sigma\)</span> in <span
class="math inline">\(O(n)\)</span> time.</em></p>
<p>We can now compute <span class="math inline">\(r\)</span>-divisions
for smaller values of <span class="math inline">\(r\)</span>, or even
hierarchies of such $r$0divisions, by applying planar algorithms to the
individual pieces of this <span
class="math inline">\((n/\bar{g})\)</span>-division.</p>
<p><strong>Corollary:</strong> <em>Given a surface map <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and Euler genus <span
class="math inline">\(\bar{g} = o(n)\)</span>, and any integer <span
class="math inline">\(r &lt; n/\bar{g}\)</span>, we can compute a nice
<span class="math inline">\(r\)</span>-division of <span
class="math inline">\(\Sigma\)</span> in <span
class="math inline">\(O(n)\)</span> time.</em></p>
<p><strong>Corollary:</strong> <em>Given a planar triangulation <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices, and any exponentially
decreasing vector <span class="math inline">\(\vec{r} = (r_1, r_2,
\dots, r_t)\)</span> with <span class="math inline">\(r_1 &lt;
n/\bar{g}\)</span>, we can construct a good <span
class="math inline">\(\vec{r}\)</span>-division of <span
class="math inline">\(\Sigma\)</span> in <span
class="math inline">\(O(n)\)</span> time.</em></p>
<h2 data-number="1.4" id="applications"><span
class="header-section-number">1.4</span> Applications</h2>
<p>This construction allows us to extend several algorithms for planar
maps to surface maps with no change in the running time, provided the
genus is sufficiently small. For example, using the planar algorithms
described earlier in these notes, we obtain the following:</p>
<p><strong>Corollary:</strong> <em>Given a surface map <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and genus <span
class="math inline">\(g = o(n/\log^2 n)\)</span>, with non-negatively
weighted darts, we can compute a single-source shortest path tree in
<span class="math inline">\(\Sigma\)</span> in <span
class="math inline">\(O(n\log\log n)\)</span> time.</em></p>
<p>(This time bound can be improved to <span
class="math inline">\(O(n)\)</span>.)</p>
<p><strong>Corollary:</strong> <em>Given a surface map <span
class="math inline">\(\Sigma\)</span> with <span
class="math inline">\(n\)</span> vertices and genus <span
class="math inline">\(g = o(n/\log^2 n)\)</span>, with arbitrarily
weighted darts, we can compute either a single-source shortest path tree
or a negative cycle in <span class="math inline">\(\Sigma\)</span> in
<span class="math inline">\(O(n\log^2 n/\log\log n)\)</span>
time.</em></p>
<p>The only significant subtlety in generalizing the planar algorithms
is some pieces in the relevant <span
class="math inline">\(r\)</span>-divisions can be adjacent to themselves
across one of the paths in <span
class="math inline">\(Q(i^*,k^*)\)</span>. Thus, “boundary vertex” does
not mean “vertex that belongs to more than one piece”; rather, pieces
are defined by slicing the surface map along certain paths and cycles,
and “boundary vertex” means a vertex on one of these slicing curves. The
dense-distance graph of a piece is defined by shortest
boundary-to-boundary paths <em>within</em> the piece, even though there
may be shorter paths that use only vertices and edges of the piece but
that that cross the boundary of the piece.</p>
<h2 data-number="1.5" id="references"><span
class="header-section-number">1.5</span> References</h2>
<ol type="1">
<li><p>Lyudmil Aleksandrov and Hristo Djidjev. <a
href="https://doi.org/10.1137/S0895480194272183">Linear algorithms for
partitioning embedded graphs of bounded genus</a>. <em>SIAM J. Discrete
Math.</em> 9(1):129–150, 1996.</p></li>
<li><p>Éric Colin de Verdière, Alfredo Hubard, and Arnaud de Mesmay. <a
href="http://doi.org/10.1007/s00454-015-9679-9">Discrete systolic
inequalities and decompositions of triangulated surfaces</a>.
<em>Discrete Comput. Geom.</em> 53(3):587–620, 2015.</p></li>
<li><p>Hristo N. Djidjev. A separator theorem. <em>C. R. Acad. Bulg.
Sci.</em> 34:643–645, 1981.</p></li>
<li><p>David Eppstein. <a
href="https://dl.acm.org/doi/10.5555/644108.644208">Dynamic generators
of topologically embedded graphs</a>. <em>Proc. 14th Ann. ACM-SIAM Symp.
Discrete Algorithms</em>, 599–608, 2003. arXiv:<a
href="https://arxiv.org/abs/cs/0207082">cs/0207082</a>.</p></li>
<li><p>John R. Gilbert, Joan P. Hutchinson, and Robert Endre Tarjan. <a
href="http://doi.org/10.1016/0196-6774(84)90019-1">A separator theorem
for graphs of bounded genus</a>. <em>J. Algorithms</em> 5(3):391–407,
1984.</p></li>
<li><p>Joan P. Hutchinson. <a href="https://doi.org/10.1137/0401020">On
short noncontractible cycles in embedded graphs</a>. <em>SIAM J.
Discrete Math.</em> 1(2):185–192, 1988.</p></li>
<li><p>Joan P. Hutchinson and Gary L. Miller. <a
href="https://doi.org/10.1016/B978-0-12-386870-1.50011-3">Deleting
vertices to make graphs of positive genus planar</a>. <em>Discrete
Algorithms and Complexity Theory, Proc. Japan-US Joint Seminar, Kyoto,
Japan</em>, 81–98, 1987. Academic Press.</p></li>
</ol>
<h2 data-number="1.6" id="aptly-named-sir"><span
class="header-section-number">1.6</span> Aptly Named Sir</h2>
<ul>
<li>Local approximation (Baker-Eppstein)</li>
</ul>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><span class="math inline">\(\dots\)</span>because it
removes all the genus.<a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>More careful analysis implies the upper bound <span
class="math inline">\(\sqrt{\bar{g} n} = \sqrt{2gn}\)</span> when <span
class="math inline">\(\Sigma\)</span> is orientable.<a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
