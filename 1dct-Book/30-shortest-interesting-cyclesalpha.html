<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jeff Erickson" />
  <title>Shortest Interesting Cycles^\alpha</title>
  <style>
    div.sitenav { display: flex; flex-direction: row; flex-wrap: wrap; }
    span.navlink { flex: 1; }
    span.navlink-label { display: inline-block; min-width: 4em; }
    html {
      font-size: 18px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 50em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<nav id="sitenav">
<div class="sitenav">
<span class="navlink">
<span class="navlink-label">Up:</span> <a href="index.html" accesskey="u" rel="up">One-Dimensional Computational Topology</a>
</span>
<span class="navlink">
<span class="navlink-label">Top:</span> <a href="index.html" accesskey="t" rel="top">One-Dimensional Computational Topology</a>
</span>
</div>
<div class="sitenav">
<span class="navlink">
<span class="navlink-label">Next:</span> <a href="31-surfaces-with-boundaryvarnothing.html" accesskey="n" rel="next">Surfaces with Boundary<span class="math inline">\(^\varnothing\)</span></a>
</span>
<span class="navlink">
<span class="navlink-label">Previous:</span> <a href="29-systems-of-cycles-and-homologyalpha.html" accesskey="p" rel="previous">Systems of Cycles and Homology<span
class="math inline">\(^\alpha\)</span></a>
</span>
</div>
</nav>
<h1 data-number="30" id="shortest-interesting-cyclesalpha"><span
class="header-section-number">30</span> Shortest Interesting Cycles<span
class="math inline">\(^\alpha\)</span></h1>
<p>In this lecture, I’ll describe algorithms to find the shortest cycle
in a surface map that is topologically interesting. I’ll specifically
consider two different definitions of “interesting”:</p>
<ul>
<li>A cycle is <em>noncontractible</em> if it cannot be continuously
deformed to a single point; noncontractible cycles are
<em>homotopically</em> nontrivial.</li>
<li>A cycle is <em>nonseparating</em> if slicing along the cycle does
not disconnect the surface; nonseparating cycles are
<em>homologically</em> nontrivial.</li>
</ul>
<p>The input to our algorithms is a surface map <span
class="math inline">\(\Sigma\)</span> with positively weighted edges.<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> I will assume throughout this
presentation that there is a unique shortest path between any pair of
vertices; this assumption can be enforced with standard perturbation
schemes. Crucially, we will treat the underlying graph of <span
class="math inline">\(\Sigma\)</span> as a continuous topologically
space; any edge with weight <span class="math inline">\(\ell\)</span> is
isometric to the interval <span class="math inline">\([0,\ell]\)</span>
on the real line. Thus, we can reasonably consider shortest paths
between points that lie in the interior of edges.</p>
<h2 data-number="30.1"
id="properties-of-shortest-nontrivial-cycles"><span
class="header-section-number">30.1</span> Properties of Shortest
Nontrivial Cycles</h2>
<p>It is unfortunately common for papers on surface-map algorithms to
use the word “cycle” in two different senses. For topologists, a
<em>cycle</em> is the continuous image of the circle <span
class="math inline">\(S^1\)</span>, but for graph theorists, a
<em>cycle</em> is a closed walk with no repeated vertices. That is,
graph theorists assume that cycles are <em>simple</em> (or
<em>injective</em>), but topologists do not. Fortunately for us,
shortest nontrivial <em>cycles</em> are the same for both tribes.</p>
<p><strong>Lemma:</strong> <em>The shortest noncontractible (or
nonseparating) closed walk in a positively edge-weighted surface map is
a simple cycle.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
For the sake of argument, suppose the shortest noncontractible closed
walk <span class="math inline">\(W\)</span> is <em>not</em> simple. We
can decompose <span class="math inline">\(W\)</span> into two closed
walks <span class="math inline">\(X\cdot Y\)</span> at any vertex that
<span class="math inline">\(W\)</span> visits more than once. <span
class="math inline">\(X\)</span> and <span
class="math inline">\(Y\)</span> are both shorter than <span
class="math inline">\(W\)</span>, so they must both be contractible. The
concatenation of two contractible closed walks is contractible. So <span
class="math inline">\(W\)</span> is contractible, contradicting its
definition. Essentially the same argument applies to the shortest
nonseparating closed walk. <span
class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<p><strong>3-Path Condition (Carsten Thomassen):</strong> <em>Let <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> be two points (either at vertices or in
edge interiors) in a surface map <span
class="math inline">\(\Sigma\)</span>, and let <span
class="math inline">\(\alpha, \beta, \gamma\)</span> be paths in <span
class="math inline">\(\Sigma\)</span> from <span
class="math inline">\(x\)</span> to <span
class="math inline">\(y\)</span>. If the cycles <span
class="math inline">\(\alpha\cdot\textsf{rev}(\beta)\)</span> and <span
class="math inline">\(\beta\cdot\textsf{rev}(\gamma)\)</span> are
contractible (resp. separating), then the cycle <span
class="math inline">\(\alpha\cdot\textsf{rev}(\gamma)\)</span> is also
contractible (resp. separating).</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
The concatenation of any two contractible closed walks is contractible.
</dd>
<dd>
The symmetric difference of any two separating cycles is separating.
<span class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<p><strong>Antipodality Condition (Carsten Thomassen):</strong> <em>Let
<span class="math inline">\(\sigma\)</span> be the shortest
noncontractible (resp. nonseparating) cycle in a surface map <span
class="math inline">\(\Sigma\)</span>. Any pair of antipodal points
partition <span class="math inline">\(\sigma\)</span> into two
equal-length shortest paths.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Fix a pair <span class="math inline">\(x\)</span> and <span
class="math inline">\(\bar{x}\)</span> of antipodal points in <span
class="math inline">\(\sigma\)</span>. These points clearly partition
<span class="math inline">\(\sigma\)</span> into two equal-length paths;
call these paths <span class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\beta\)</span>. Suppose <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\beta\)</span> are <em>not</em> shortest paths,
and let <span class="math inline">\(\gamma\)</span> be a shortest path
from <span class="math inline">\(x\)</span> to <span
class="math inline">\(\bar{x}\)</span>. The cycles <span
class="math inline">\(\alpha\cdot\textsf{rev}(\gamma)\)</span> and <span
class="math inline">\(\beta\cdot\textsf{rev}(\gamma)\)</span> are both
shorter than <span class="math inline">\(\alpha\cdot\textsf{rev}(\beta)
= \sigma\)</span> and thus are contractible (resp. separating). But then
the 3-path property implies that <span
class="math inline">\(\sigma\)</span> is contractible (resp.
separating), contradicting its definition. <span
class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<p><strong>Crossing Condition:</strong> <em>Any shortest path crosses
the shortest noncontractible (resp. nonseparating) cycle at most
once.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Let <span class="math inline">\(\pi\)</span> be a shortest path and let
<span class="math inline">\(\sigma\)</span> be a simple noncontractible
(resp. separating) cycle, and suppose the intersection <span
class="math inline">\(\pi\cap\sigma\)</span> is disconnected. Then we
can decompose <span class="math inline">\(\pi\)</span> into three
subpaths <span
class="math inline">\(\pi^-\cdot\pi^\circ\cdot\pi^+\)</span>, where
<span class="math inline">\(\pi^\circ\)</span> starts and ends at
vertices of <span class="math inline">\(\sigma\)</span> but is otherwise
disjoint from <span class="math inline">\(\sigma\)</span>. Because <span
class="math inline">\(\pi\)</span> is a shortest path, its subpath <span
class="math inline">\(\pi^circ\)</span> is also a shortest path.
Similarly, we can decompose <span class="math inline">\(\sigma\)</span>
into two paths <span class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\beta\)</span> at the endpoints of <span
class="math inline">\(\pi^\circ\)</span>. The 3-path condition implies
that at least one of the cycles <span
class="math inline">\(\alpha\cdot\textsf{rev}(\pi^\circ)\)</span> and
<span class="math inline">\(\beta\cdot\textsf{rev}(\pi^\circ)\)</span>
is noncontractible (resp. nonseparating). Because vertex-to-vertex
shortest paths are unique, both of these cycles are shorter than <span
class="math inline">\(\sigma\)</span>. <span
class="math inline">\(\qquad\square\)</span>
</dd>
</dl>
<h2 data-number="30.2" id="a-polynomial-time-algorithm"><span
class="header-section-number">30.2</span> A polynomial-time
algorithm</h2>
<p>Thomassen’s 3-path condition implies the following algorithm to find
the shortest noncontractible cycle <span
class="math inline">\(\sigma\)</span>. The antipodality condition
implies that <span class="math inline">\(\sigma\)</span> must consist of
a shortest path from a vertex <span class="math inline">\(x\)</span> to
another vertex <span class="math inline">\(y\)</span>, the edge <span
class="math inline">\(yz\)</span>, and the shortest path from <span
class="math inline">\(z\)</span> back to <span
class="math inline">\(x\)</span>. (Uniqueness of vertex-to-vertex
shortest paths implies that the antipodal point <span
class="math inline">\(\bar{x}\)</span> lies in the interior of the edge
<span class="math inline">\(yz\)</span>.) There are only <span
class="math inline">\(O(n^2)\)</span> loops of this form. We compute the
distance between every pair of vertices in <span
class="math inline">\(O(n^2\log n)\)</span> time by running Dijkstra’s
algorithm <span class="math inline">\(n\)</span> times, after which we
can compute the length of each candidate cycle in <span
class="math inline">\(O(1)\)</span> time. Finally, for each candidate
loop <span class="math inline">\(\gamma\)</span>, we test whether <span
class="math inline">\(\gamma\)</span> is contractible in <span
class="math inline">\(O(n)\)</span> time, using Dehn’s algorithm.
Finally, we return the shortest candidate cycle that is
noncontractible.</p>
<p><strong>Theorem [Thomassen]:</strong> <em>Given any edge-weighted
surface map <span class="math inline">\(\Sigma\)</span> with complexity
<span class="math inline">\(n\)</span>, we can compute the shortest
noncontractible cycle in <span class="math inline">\(\Sigma\)</span> in
<span class="math inline">\(O(n^3)\)</span> time.</em></p>
<p>In fact, Dehn’s algorithm is overkill for testing the contractibility
of simple cycles. Instead we can rely on the classical lemma:</p>
<p><strong>Lemma [David Epstein<a href="#fn2" class="footnote-ref"
id="fnref2" role="doc-noteref"><sup>2</sup></a>]:</strong> <em>A
nontrivial simple cycle <span class="math inline">\(\sigma\)</span> on
any surface <span class="math inline">\(\mathcal{S}\)</span> is
contractible if and only if <span
class="math inline">\(\mathcal{S}\setminus \sigma\)</span> is
disconnected and at least one component is an open disk.</em></p>
<p>We can test whether a simple cycle <span
class="math inline">\(\sigma\)</span> is the boundary of a disk as
follows. First, we perform a whatever-first search in the dual map <span
class="math inline">\(\Sigma^*\)</span> to determine whether the sliced
map <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} \sigma\)</span> (or alternatively,
the contracted map <span class="math inline">\(\Sigma / \sigma\)</span>)
is connected. If <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} \sigma\)</span> is connected, then
<span class="math inline">\(\sigma\)</span> is noncontractible.
Otherwise, we compute the Euler characteristics and orientability of
both components in <span class="math inline">\(O(n)\)</span> time. If
either component is orientable with genus <span
class="math inline">\(1\)</span>, that component is a disk and <span
class="math inline">\(\sigma\)</span> is contractible; otherwise, <span
class="math inline">\(\sigma\)</span> is non-contractible.</p>
<p>We can find the shortest <em>nonseparating</em> cycle in the same
time bound, using a slightly <em>simpler</em> algorithm. A given simple
cycle <span class="math inline">\(\sigma\)</span> is non-separating if
and only if <span class="math inline">\(\Sigma
\mathbin{\backslash\!\!\backslash} \sigma\)</span> is connected; we can
test this condition in <span class="math inline">\(O(n)\)</span> time
using whatever-first search in the dual map <span
class="math inline">\(\Sigma^*\)</span>. Otherwise, the algorithm is the
same.</p>
<p><strong>Theorem [Thomassen]:</strong> <em>Given any edge-weighted
surface map <span class="math inline">\(\Sigma\)</span> with complexity
<span class="math inline">\(n\)</span>, we can compute the shortest
nonseparating cycle in <span class="math inline">\(\Sigma\)</span> in
<span class="math inline">\(O(n^3)\)</span> time.</em></p>
<h2 data-number="30.3" id="near-quadratic-time"><span
class="header-section-number">30.3</span> Near-quadratic time</h2>
<ul>
<li><p>Build a tree-cotree decomposition <span
class="math inline">\((T,L,C)\)</span> where <span
class="math inline">\(T\)</span> is a shortest-path tree, in <span
class="math inline">\(O(n\log n)\)</span> time, using Dijkstra’s
algorithm.</p></li>
<li><p>Let <span class="math inline">\(X^*\)</span> be the <em>dual</em>
cut graph <span class="math inline">\((C\cup L)^*\)</span>. A
fundamental loop <span
class="math inline">\(\textsf{loop}(x,yz)\)</span> is separating if and
only if <span class="math inline">\((yz)^*\)</span> is a bridge of <span
class="math inline">\(X^*\)</span>, and contractible if and only if at
least one component of <span class="math inline">\(X^*\setminus
(yz)^*\)</span> is a tree.</p></li>
<li><p>We can classify every edge of <span
class="math inline">\(X^*\)</span> as hair, bridge, or neither in <span
class="math inline">\(O(n)\)</span> time. So we can find shortest
noncontractible and nonseparating loops based at <span
class="math inline">\(x\)</span> in <span class="math inline">\(O(n\log
n)\)</span> time.</p></li>
<li><p>Try all basepoints <span class="math inline">\(\implies O(n^2\log
n)\)</span> time.</p></li>
</ul>
<p>The high-level approach of this algorithm is due to Sariel Har-Peled
and me, but we used a much more complicated algorithm to find shortest
interesting loops, which interleaves Dijkstra steps and brute-force
traversal of the dual map. Replacing Dijkstra’s algorithm with a
linear-time shortest-path algorithm reduces the overall running time to
<span class="math inline">\(O(n^2)\)</span>.</p>
<p>This is the fastest algorithm known for arbitrary genus. However,
Martin Kutz proved that for any <em>constant</em> genus <span
class="math inline">\(g\)</span>, it is possible to computer shortest
nontrivial cycles in only <span class="math inline">\(O(n\log
n)\)</span> time, by a reduction to the planar minimum-cut problem (or
more properly, to the dual problem of finding the shortest generating
cycle in an annulus). The running time of Kutz’s algorithm depends
exponentially on the genus. Later work by Sergio Cabello and Erin
Chambers reduced the dependence on <span
class="math inline">\(g\)</span> to a small polynomial.</p>
<h2 data-number="30.4" id="multiple-source-shortest-paths"><span
class="header-section-number">30.4</span> Multiple-Source Shortest
Paths</h2>
<p>We can significantly improve Thomassen’s algorithm using a
generalization of either of the multiple-source shortest path algorithms
that we saw earlier for planar maps.</p>
<p><strong><em>[The rest of this section is only an
outline.]</em></strong></p>
<h3 class="unnumbered" id="parametric">Parametric</h3>
<p>Grove decomposition of the dual cut graph <span
class="math inline">\(T\cup L\)</span> into <span
class="math inline">\(O(g)\)</span> trees, each with a central cut path.
Each pivot requires <span class="math inline">\(O(g)\)</span>
dynamic-forest operations, and thus takes <span
class="math inline">\(O(g\log n)\)</span> amortised time. Each dart
pivots into the shortest path tree <span
class="math inline">\(T\)</span> at most <span
class="math inline">\(O(g)\)</span> times. Total time is <span
class="math inline">\(O(g^2 n\log n)\)</span>, assuming generic edge
weights. This can be improved to <span class="math inline">\(O(gn\log
n)\)</span> time with more careful data structures and analysis.</p>
<figure>
<img src="Fig/grove-link-cut.png" style="width:75.0%"
alt="Pivoting one edge into a grove decomposition." />
<figcaption aria-hidden="true">Pivoting one edge into a grove
decomposition.</figcaption>
</figure>
<dl>
<dt><strong>Surface-Tree Lemma:</strong></dt>
<dd>
<em>Let <span class="math inline">\(T\)</span> be any tree embedded on a
surface with exactly one boundary cycle <span
class="math inline">\(B\)</span>; call any vertex in <span
class="math inline">\(T\cap B\)</span> a boundary vertex. Let <span
class="math inline">\(e\)</span> be any edge of <span
class="math inline">\(T\)</span>, and let <span
class="math inline">\(U\)</span> and <span
class="math inline">\(W\)</span> be the components of <span
class="math inline">\(T\setminus e\)</span>. Either <span
class="math inline">\(U\)</span> contains every boundary vertex, or
boundary vertices in <span class="math inline">\(U\)</span> induce at
most <span class="math inline">\(g+1\)</span> paths in <span
class="math inline">\(B\)</span>.</em>
</dd>
<dt><strong>Proof(?):</strong></dt>
<dd>
Let <span class="math inline">\(\Sigma\)</span> be the surface map
induced by <span class="math inline">\(T \cup B\)</span>, and let <span
class="math inline">\(o\)</span> be the face of <span
class="math inline">\(\Sigma\)</span> bounded by <span
class="math inline">\(B\)</span>. Let <span
class="math inline">\((T,L,C)\)</span> be any tree-cotree decomposition
of <span class="math inline">\(\Sigma\)</span> with the given spanning
tree <span class="math inline">\(T\)</span>.
</dd>
<dd>
<p>Consider the subgraph <span class="math inline">\(X^* = C^*\cup L^*
\cup \{e^*\}\)</span> of the dual map <span
class="math inline">\(\Sigma^*\)</span>. The induced embedding of <span
class="math inline">\(X^*\)</span> has exactly two faces, each
containing (the faces of <span class="math inline">\(\Sigma^*\)</span>
dual to vertices of) one component of <span class="math inline">\(T
\setminus e\)</span>. Let <span class="math inline">\(Y^*\)</span> be
the boundary subgraph comprised of the non-isthmus edges of <span
class="math inline">\(X^*\)</span>. This boundary subgraph can be
decomposed into at most <span class="math inline">\(g+1\)</span> simple
non-crossing cycles. (Recall the the <em>definition</em> of the genus
<span class="math inline">\(G\)</span> is the maximum number of disjoint
cycles whose deletion does not disconnect the surface.) Each of these
cycles crosses <span class="math inline">\(B\)</span> at most twice.
Thus, either <span class="math inline">\(X^*\)</span> does not cross
<span class="math inline">\(B\)</span> at all, or <span
class="math inline">\(X^*\)</span> splits <span
class="math inline">\(B\)</span> into at most <span
class="math inline">\(2g+2\)</span> intervals, which alternate between
vertices of <span class="math inline">\(U\)</span> and vertices of <span
class="math inline">\(W\)</span>. <span
class="math inline">\(\qquad\square\)</span></p>
</dd>
</dl>
<h3 class="unnumbered" id="recursive">Recursive</h3>
<p>Precompute homology annotations (via a system of cocycles) once at
the start. Compute shortest-path trees <span
class="math inline">\(T_i\)</span> and <span
class="math inline">\(T_j\)</span> in <span
class="math inline">\(O(n\log n)\)</span> time. Compute homology
signatures of all shortest paths from <span
class="math inline">\(s_i\)</span> and <span
class="math inline">\(s_k\)</span> in <span
class="math inline">\(O(gn)\)</span> time. Dart <span
class="math inline">\({u{\to}v}\)</span> is properly shared by <span
class="math inline">\(T_i\)</span> and <span
class="math inline">\(T_k\)</span> if it satisfies the following
conditions:</p>
<ul>
<li><span class="math inline">\(\textsf{pred}_i(v) = \textsf{pred}_k(v)
= u\)</span></li>
<li><span class="math inline">\([\textsf{path}_i(u)] =
[\textsf{path}_k(u)]\)</span> — <strong>This condition is
new!</strong></li>
<li>If <span class="math inline">\(t = \textsf{pred}_i(u) =
\textsf{pred}_k(u)\)</span>, then <span
class="math inline">\(t{\to}u\)</span> is properly shared by <span
class="math inline">\(T_i\)</span> and <span
class="math inline">\(T_k\)</span>.</li>
<li>Otherwise, darts <span
class="math inline">\(\textsf{pred}_i(u){\to}u\)</span> and <span
class="math inline">\(v{\to}u\)</span> and <span
class="math inline">\(\textsf{pred}_k(u){\to}u\)</span> are oriented
clockwise around <span class="math inline">\(u\)</span>.</li>
</ul>
<p>The second condition holds if and only if these two shortest paths
define a separating arc from <span class="math inline">\(s_i\)</span>
through <span class="math inline">\(u\)</span> to <span
class="math inline">\(s_k\)</span>.</p>
<p>Finding and contracting all properly shared darts takes <span
class="math inline">\(O(gn)\)</span> time. Each vertex has <span
class="math inline">\(O(g\deg(v))\)</span> interesting sources, so the
total size of all maps at each level of recursion is <span
class="math inline">\(O(gn)\)</span>. The total preprocessing time is
<span class="math inline">\(O(gn\log n + g^2 n)\)</span>; the query time
is still <span class="math inline">\(O(\log n)\)</span>. It’s unclear
whether <span class="math inline">\(O(gn\log n)\)</span> time can be
achieved with this approach.</p>
<h2 data-number="30.5"
id="shortest-nonseparating-cycles-in-near-linear-time"><span
class="header-section-number">30.5</span> Shortest Nonseparating Cycles
in Near-Linear Time</h2>
<p><strong>Lemma [Cabello Mohar]:</strong> <em>The shortest
nonseparating cycle in any surface map <span
class="math inline">\(\Sigma\)</span> crosses at least one cycle in a
greedy system of cycles for <span class="math inline">\(\Sigma\)</span>
exactly once.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
<strong><em>[[[to be written. The usual exchange argument implies 3
crossings is impossible, and every nonseparating cycle crosses some
basis cycle an odd number of times]]]</em></strong>
</dd>
</dl>
<p><strong>Lemma:</strong> <em>For any cycle <span
class="math inline">\(\gamma\)</span>, the shortest cycle that crosses
<span class="math inline">\(\gamma\)</span> exactly once can be computed
in <span class="math inline">\(O(\bar{g}^2 n\log n)\)</span>
time.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Let <span class="math inline">\(\Sigma’ = \Sigma
\mathbin{\backslash\!\!\backslash} \gamma\)</span>. If <span
class="math inline">\(\gamma\)</span> is two-sided, then <span
class="math inline">\(\Sigma’\)</span> has two boundary cycles <span
class="math inline">\(\gamma^-\)</span> and <span
class="math inline">\(\gamma^+\)</span>, each of which is a copy of
<span class="math inline">\(\gamma\)</span>. If <span
class="math inline">\(\gamma\)</span> is one-sided, then <span
class="math inline">\(\Sigma’\)</span> has a single boundary cycle <span
class="math inline">\(\gamma^\pm\)</span> that covers <span
class="math inline">\(\gamma\)</span> twice. In either case, <span
class="math inline">\(\Sigma’\)</span> contains two copies <span
class="math inline">\(v^-\)</span> and <span
class="math inline">\(v^+\)</span> of every vertex <span
class="math inline">\(v\)</span> of <span
class="math inline">\(\gamma\)</span>.
</dd>
<dd>
<p>Now let <span class="math inline">\(\sigma\)</span> be the shortest
cycle in <span class="math inline">\(\Sigma\)</span> that crosses <span
class="math inline">\(\gamma\)</span> once. This cycle appears in <span
class="math inline">\(\Sigma’\)</span> as a shortest path from <span
class="math inline">\(v^-\)</span> to <span
class="math inline">\(v^+\)</span> for some vertex <span
class="math inline">\(v\)</span> of <span
class="math inline">\(\Sigma\)</span>. We can compute all such shortest
paths in <span class="math inline">\(O(\bar{g}^2 n\log n)\)</span> time
using either MSSP algorithm, using either <span
class="math inline">\(\gamma^+\)</span> or <span
class="math inline">\(\gamma^\pm\)</span> as the “outer” face. <span
class="math inline">\(\qquad\square\)</span></p>
</dd>
</dl>
<p><strong>Theorem:</strong> <em>The shortest nonseparating cycle in a
surface map with Euler genus <span
class="math inline">\(\bar{g}\)</span> and complexity <span
class="math inline">\(n\)</span> can be computed in <span
class="math inline">\(O(\bar{g}^3 n\log n)\)</span> time.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Let <span class="math inline">\((T,L,C)\)</span> be a tree-cotree
decomposition of <span class="math inline">\(\Sigma\)</span> where <span
class="math inline">\(T\)</span> is a shortest-path tree. Let <span
class="math inline">\(Q\)</span> be the reduced cur graph obtained by
removing degree-1 vertices from <span class="math inline">\(T\cup
L\)</span>, and let <span class="math inline">\(\mathcal{C} =
\{\gamma_1, \gamma_2, \dots, \gamma_{\bar{g}} \}\)</span> be the system
of cycles induced by <span class="math inline">\(T\)</span> and <span
class="math inline">\(L\)</span>.
</dd>
<dd>
<p>For each cycle <span class="math inline">\(\gamma_i\)</span>, we
compute the shortest cycle in <span
class="math inline">\(\Sigma\)</span> that crosses <span
class="math inline">\(\gamma_i\)</span> exactly once, in <span
class="math inline">\(O(\bar{g}n\log n)\)</span> time, by running a
multiple-source shortest-path algorithm in <span
class="math inline">\(\Sigma \mathbin{\backslash\!\!\backslash}
\gamma_i\)</span>. The shortest of these <span
class="math inline">\(\bar{g}\)</span> cycles is the shortest
nonseparating cycle. <span
class="math inline">\(\qquad\square\)</span></p>
</dd>
</dl>
<h2 data-number="30.6"
id="shortest-noncontractible-cycles-in-near-linear-time-sketch"><span
class="header-section-number">30.6</span> Shortest Noncontractible
Cycles in Near-Linear Time (sketch)</h2>
<p>This one is a bit more complicated.</p>
<p><strong>Lemma:</strong> <em>Every noncontractible cycle in any
surface map <span class="math inline">\(\Sigma\)</span> crosses any cut
graph of <span class="math inline">\(\Sigma\)</span> at least
once.</em></p>
<p>The following lemma distills a more complex argument of Cabello,
Chambers, and Erickson. <strong><em>[[[Take this with a grain of salt
until I wrote down a complete proof.]]]</em></strong></p>
<p><strong>Lemma:</strong> <em>Let <span
class="math inline">\(\sigma\)</span> be the shortest noncontractible
cycle in some surface map <span class="math inline">\(\Sigma\)</span>.
Let <span class="math inline">\((T,L,C)\)</span> be a tree-cotree
decomposition of <span class="math inline">\(\Sigma\)</span> where <span
class="math inline">\(T\)</span> is a shortest path tree and <span
class="math inline">\(C\)</span> is a maximum spanning tree. Let <span
class="math inline">\(\mathcal{C}\)</span> denote the corresponding
system of cycles.</em></p>
<ol type="a">
<li><em><span class="math inline">\(\sigma\)</span> crosses each cycle
in <span class="math inline">\(\mathcal{C}\)</span> at most
once.</em></li>
<li><em><span class="math inline">\(\sigma\)</span> is a nonseparating
cycle if and only if <span class="math inline">\(\sigma\)</span> crosses
some cycle in <span class="math inline">\(\mathcal{C}\)</span> at least
once.</em></li>
<li><em>If <span class="math inline">\(\sigma\)</span> is a separating
cycle, then <span class="math inline">\(\sigma\)</span> is also the
shortest non-contractible cycle in <span class="math inline">\(\Sigma’ =
\Sigma {\backslash\!\!\backslash} \mathcal{C}\)</span>.</em></li>
</ol>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
<strong><em>[[[To be written. Notice that (a) is a stronger claim than
the nonseparating crossing lemma!]]]</em></strong>
</dd>
</dl>
<p><strong>Lemma:</strong> <em>Let <span
class="math inline">\(\sigma\)</span> be the shortest noncontractible
cycle in some surface map <span class="math inline">\(\Sigma’\)</span>
with genus <span class="math inline">\(0\)</span> and at least two
boundaries. Let <span class="math inline">\(\pi\)</span> be the shortest
path between any two boundaries of <span
class="math inline">\(\Sigma’\)</span>. Either (a) <span
class="math inline">\(\sigma\)</span> crosses <span
class="math inline">\(\pi\)</span> exactly once, or (b) <span
class="math inline">\(\sigma\)</span> does not cross <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> is the shortest noncontractible
cycle in <span class="math inline">\(\Sigma’ {\backslash\!\!\backslash}
\pi\)</span>.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
<strong><em>[[[Mostly follows from the Crossing
Condition.]]]</em></strong>
</dd>
</dl>
<p><strong>Theorem:</strong> <em>The shortest noncontractible cycle in a
surface map with Euler genus <span
class="math inline">\(\bar{g}\)</span> and complexity <span
class="math inline">\(n\)</span> can be computed in <span
class="math inline">\(O(\bar{g}^3 n\log n)\)</span>.</em></p>
<dl>
<dt><strong>Proof:</strong></dt>
<dd>
Let <span class="math inline">\((T,L,C)\)</span> be a tree-cotree
decomposition of <span class="math inline">\(\Sigma\)</span> where <span
class="math inline">\(T\)</span> is a shortest-path tree and <span
class="math inline">\(C\)</span> is a maximum spanning tree. Let <span
class="math inline">\(\mathcal{C} = \{\gamma_1, \gamma_2, \dots,
\gamma_{\bar{g}} \}\)</span> be the system of cycles induced by <span
class="math inline">\(T\)</span> and <span
class="math inline">\(L\)</span>.
</dd>
<dd>
<p>First, for each cycle <span class="math inline">\(\gamma_i\)</span>,
we compute the shortest cycle in <span
class="math inline">\(\Sigma\)</span> that crosses <span
class="math inline">\(\gamma_i\)</span> exactly once, in <span
class="math inline">\(O(\bar{g}^2 n\log n)\)</span> time, by running a
multiple-source shortest-path algorithm in <span
class="math inline">\(\Sigma \mathbin{\backslash\!\!\backslash}
\gamma_i\)</span>. The shortest of these <span
class="math inline">\(\bar{g}\)</span> cycles is the shortest
nonseparating cycle. Thus, if the shortest noncontractible cycle is
nonseparating, then the shortest of these <span
class="math inline">\(\bar{g}\)</span> cycles is the shortest
noncontractible cycle. Otherwise, we need to compute the shortest
noncontractible cycle in the sliced surface <span
class="math inline">\(\Sigma’ = \Sigma
\mathbin{\backslash\!\!\backslash} \mathcal{C}\)</span>.</p>
</dd>
<dd>
<p>The surface <span class="math inline">\(\Sigma’\)</span> has genus 0
and <span class="math inline">\(b\)</span> boundary cycles, for some
<span class="math inline">\(1\le b\le \bar{g}\)</span>. If <span
class="math inline">\(b=1\)</span>, then <span
class="math inline">\(\Sigma’\)</span> is a disk, so every cycle in
<span class="math inline">\(\Sigma’\)</span> is contractible. Otherwise,
we compute a shortest path <span class="math inline">\(\pi\)</span>
between any two boundary cycles, compute the shortest cycle <span
class="math inline">\(\sigma^\times\)</span> in <span
class="math inline">\(\Sigma’\)</span> that crosses <span
class="math inline">\(\pi\)</span> exactly once via multiple-source
shortest paths, and recursively search <span
class="math inline">\(\Sigma’ \mathbin{\backslash\!\!\backslash}
\pi\)</span>. The algorithm halts after computing <span
class="math inline">\(b-1\)</span> cycles; the shortest of these is the
shortest noncontractible cycle in <span
class="math inline">\(\Sigma’\)</span>.</p>
</dd>
<dd>
<p>Altogether the algorithm runs multiple-source shortest paths <span
class="math inline">\(\bar{g} + b = O(\bar{g})\)</span> times, each on a
surface map with complexity <span class="math inline">\(O(n)\)</span>
and genus less than <span class="math inline">\(\bar{g}\)</span>. So the
overall running time is <span class="math inline">\(O(\bar{g}^3 n\log
n)\)</span>, as claimed. <span
class="math inline">\(\qquad\square\)</span></p>
</dd>
</dl>
<!--

## Making Shortest Paths Unique

1. Randomized weight perturbation (with high probability)
2. Lexicographic perturbation ($\times O(\log n)$)
3. holiest perturbation ($\times O(g)$)

## Shortest System of Loops

$\Lambda = \Sigma / T \ C$, where $T$ is shortest-path tree from basepoint and $C$ is maximum spanning tree.  Éric’s optimality proof via pointed homology.

## Shortest System of Arcs

$\Lambda = \Sigma / F \ C$, where $F$ is shortest-path forest from boundary and $C$ is maximum spanning tree.  Optimality proof via relative homology.

## Shortest (Co)Homology Bases
Matroid optimization
-->
<h2 data-number="30.7" id="references-20"><span
class="header-section-number">30.7</span> References</h2>
<ol type="1">
<li><p>Sergio Cabello, Erin W. Chambers, and Jeff Erickson. <a
href="http://doi.org/10.1137/12086427">Multiple-source shortest paths in
embedded graphs</a>. <em>SIAM J. Comput.</em> 42(4):1542–1571, 2013.
arXiv:<a href="https://arxiv.org/abs/1804.01045">1202.0314</a>.</p></li>
<li><p>Sergio Cabello and Bojan Mohar. <a
href="http://doi.org/10.1007/s00454-006-1292-5">Finding shortest
non-separating and non-contractible cycles for topologically embedded
graphs</a>. <em>Discrete Comput. Geom.</em> 37(2):213–235,
2007.</p></li>
<li><p>David B. A. Epstein. <a
href="http://doi.org/10.1007/BF02392203">Curves on 2-manifolds and
isotopies</a>. <em>Acta Math.</em> 115:83–107, 1966.</p></li>
<li><p>Jeff Erickson. <a
href="http://doi.org/10.1145/1998196.1998231">Shortest non-trivial
cycles in directed surface graphs</a>. <em>Proc. 27th Ann. Symp. Comput.
Geom.</em>, 236–243, 2011.</p></li>
<li><p>Jeff Erickson, Emily Kyle Fox, and Luvsandondov Lkhamsuren. <a
href="http://doi.org/10.1145/3188745.3188904">Holiest minimum-cost paths
and flows in surface graphs</a>. <em>Proc. 50th Ann. ACM Symp. Theory
Comput.</em>, 1319–1332, 2018. arXiv:<a
href="https://arxiv.org/abs/1804.01045">1804.01045</a>.</p></li>
<li><p>Jeff Erickson and Sariel Har-Peled. <a
href="http://doi.org/10.1007/s00454-003-2948-z">Optimally cutting a
surface into a disk</a>. <em>Discrete Comput. Geom.</em> 31(1):37–59,
2004. arXiv:<a
href="https://arxiv.org/abs/cs/0207004">cs/0207004</a>.</p></li>
<li><p>Emily Kyle Fox. <a
href="http://doi.org/10.1137/1.9781611973105.26">Shortest non-trivial
cycles in directed and undirected surface graphs</a>. <em>Proc. 24th
Ann. ACM-SIAM Symp. Discrete Algorithms</em>, 352–364, 2013. arXiv:<a
href="https://arxiv.org/abs/1111.6990">1111.6990</a>.</p></li>
<li><p>Martin Kutz. <a
href="http://doi.org/10.1145/1137856.1137919">Computing shortest
non-trivial cycles on orientable surfaces of bounded genus in almost
linear time</a>. <em>Proc. 22nd Ann. Symp. Comput. Geom.</em>, 430–438,
2006. arXiv:<a
href="https://arxiv.org/abs/cs/0512064">cs/0512064</a>.</p></li>
<li><p>Carsten Thomassen. <a
href="http://doi.org/10.1016/0095-8956(90)90115-G">Embeddings of graphs
with no short noncontractible cycles</a>. <em>J. Comb. Theory Ser.
B</em> 48(2):155–177, 1990.</p></li>
</ol>
<h2 data-number="30.8" id="aptly-named-sir-4"><span
class="header-section-number">30.8</span> Aptly Named Sir</h2>
<ul>
<li>Enforcing shortest-path and optimal-cycle uniqueness</li>
<li>Tight cycles</li>
<li>Directed graphs</li>
<li>Shortest systems of loops, arcs, or cycles</li>
<li>Shortest <em>homotopic</em> paths, cycles, systems of loops, pants
decompositions</li>
</ul>
<aside id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>With more effort, these algorithms can be generalized to
<em>directed</em> surface maps with asymmetrically weighted
<em>darts</em>.<a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>David Epstein-with-one-p is a curly-haired English
mathematician who was born in South Africa. David Eppstein-with-two-p’s
is a curly-haired American mathematician (and computer scientist) who
was born in England. It’s a minor miracle that they have never been
coauthors.<a href="#fnref2" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>
</body>
</html>
